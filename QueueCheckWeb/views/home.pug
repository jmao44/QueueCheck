doctype html
html
    head
        title Home
        style.
            #map {
                height: 600px;
                width:100%;
            }
    body
        h1 Home Page
        ul(hidden)
            each loc in coordMaps
                li=loc.name
                ul
                    li=loc.coord.lat
                    li=loc.coord.lon
        p(hidden id="naDescrip")=naDescrip
        p(hidden id="wvDescrip")=wvDescrip
        p(hidden id="libDescrip")=libDescrip

        p(hidden id="wvWaitTime")=waitTimes[1]
        p(hidden id="libWaitTime")=waitTimes[2]
        p(hidden id="naWaitTime")=waitTimes[3]

        div(id="map")
        script(async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARsNpnQRNR3hmJphz_FOSiMyU33ScK69M&callback=initMap&libraries=&v=weekly")
        script.
            const locations = [
                { lat: 33.7804494335901, lng: -84.4049251642794 },
                { lat: 33.774241092779, lng: -84.3951471683685 },
                { lat: 33.7710653643324, lng: -84.3915450543985 }
            ]

            const naDescrip = document.getElementById("naDescrip").textContent
            const wvDescrip = document.getElementById("wvDescrip").textContent
            const libDescrip = document.getElementById("libDescrip").textContent

            const wvWaitTime = parseInt(document.getElementById("wvWaitTime").textContent)
            const libWaitTime = parseInt(document.getElementById("libWaitTime").textContent)
            const naWaitTime = parseInt(document.getElementById("naWaitTime").textContent)

            function outputTime(wt) {
                if (wt == -1) {
                    return "Collecting more data"
                } else {
                    return wt.toString()
                }
            }

            function initMap() {
                const gt = { lat: 33.7756, lng: -84.3963}
                const map = new google.maps.Map(document.getElementById("map"), {
                    zoom: 15,
                    center: gt
                })

                const markers = locations.map((location, i) => {
                    return new google.maps.Marker({
                        position: location,
                        map: map
                    })
                })

                let iw = new google.maps.InfoWindow({
                    content: wvDescrip,
                });
                markers[0].addListener("click", () => {
                    iw.open(map, markers[0])
                })
                ////////////////
                let iw1 = new google.maps.InfoWindow({
                    content: libDescrip,
                });
                markers[1].addListener("click", () => {
                    iw1.open(map, markers[1])
                })
                ///////////////
                let iw2 = new google.maps.InfoWindow({
                    content: naDescrip,
                });
                markers[2].addListener("click", () => {
                    iw2.open(map, markers[2])
                })

                google.maps.event.addListener(iw, 'domready', function() {
                    var wvEstimate = document.getElementById("wvEstimate")
                    wvEstimate.innerHTML = wvEstimate.innerHTML + outputTime(wvWaitTime)
                })
                google.maps.event.addListener(iw1, 'domready', function() {
                    var libEstimate = document.getElementById("libEstimate")
                    libEstimate.innerHTML = libEstimate.innerHTML + outputTime(libWaitTime)
                })
                google.maps.event.addListener(iw2, 'domready', function() {
                    var naEstimate = document.getElementById("naEstimate")
                    naEstimate.innerHTML = naEstimate.innerHTML + outputTime(naWaitTime)
                })

            }